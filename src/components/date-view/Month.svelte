<script>
  import Week from './Week.svelte'
  import { contextKey } from '../lib/context'
  import { getContext } from 'svelte'
  import { sortedDaysOfWeek } from '../lib/time'

  export let id

  const { monthView } = getContext(contextKey)

  let lastId = id
  let direction

  $: {
    direction = lastId < id ? 1 : -1
    lastId = id
  }
</script>

<div class="month-container">
  <div class="month-dates">
    <div class="legend">
      <div class="month-week">
        {#each sortedDaysOfWeek as day}
          <span>{day[1]}</span>
        {/each}
      </div>
    </div>
    {#each $monthView.visibleMonth.weeks as week (week.id)}
      <Week 
        days={week.days}
        {direction}
        on:chosen
      />
    {/each}
  </div>
</div>

<style>
  .month-dates { 
    width: 100%;
    display: -ms-grid;
    display: grid;
    -ms-grid-columns: 1fr;
    -ms-grid-rows: 1fr;
  }

  @media (min-width: 600px) {
    .month-container {
      display: flex;
    }
    .month-week {
      width: 100%;
    }
  }

  .legend {
    display: grid;
    grid-row: 1 / 2;
    color: #4a4a4a;
    padding: 10px 0;
    margin-bottom: 5px;
  }

  .legend span {
    width: 14.285714%;
    display: inline-block;
    text-align: center;
  }
</style>
